import{v as F,b as s,m as $,n as A,f as D,w as J,e as S,a as M,q as U,p as H,k as K,i as k,y as P,j as v,t as I,S as Q,F as X}from"./web-DuEVvOp5.js";import{c as Y,d as Z,a as ee}from"./JNCCF6MP-yLk7z_SF.js";import{_ as te,P as _,m as T,J as re,e as ae,l as ne}from"./UKTBL2JL-CnBKWN1M.js";import{u as se,g as oe}from"./Context-D0aeQrfF.js";import"./chess-lriRiorr.js";var le={};te(le,{Fill:()=>j,Label:()=>E,Progress:()=>b,Root:()=>G,Track:()=>N,ValueLabel:()=>O});var R=U();function V(){const t=H(R);if(t===void 0)throw new Error("[kobalte]: `useProgressContext` must be used within a `Progress.Root` component");return t}function j(t){const r=V(),[i,e]=F(t,["style"]);return s(_,$({as:"div",get style(){return Y({"--kb-progress-fill-width":r.progressFillWidth()},i.style)}},()=>r.dataset(),e))}function E(t){const r=V(),i=T({id:r.generateId("label")},t),[e,d]=F(i,["id"]);return A(()=>D(r.registerLabelId(e.id))),s(_,$({as:"span",get id(){return e.id}},()=>r.dataset(),d))}function G(t){const r=`progress-${J()}`,i=T({id:r,value:0,minValue:0,maxValue:100},t),[e,d]=F(i,["value","minValue","maxValue","indeterminate","getValueLabel"]),[c,L]=S(),C=Z(()=>({style:"percent"})),a=()=>re(e.value,e.minValue,e.maxValue),n=()=>(a()-e.minValue)/(e.maxValue-e.minValue),g=()=>{if(!e.indeterminate)return e.getValueLabel?e.getValueLabel({value:a(),min:e.minValue,max:e.maxValue}):C().format(n())},x=()=>e.indeterminate?void 0:`${Math.round(n()*100)}%`,m=M(()=>{let o;return e.indeterminate||(o=n()===1?"complete":"loading"),{"data-progress":o,"data-indeterminate":e.indeterminate?"":void 0}}),p={dataset:m,value:a,valuePercent:n,valueLabel:g,labelId:c,progressFillWidth:x,generateId:ae(()=>d.id),registerLabelId:ee(L)};return s(R.Provider,{value:p,get children(){return s(_,$({as:"div",role:"progressbar",get"aria-valuenow"(){return M(()=>!!e.indeterminate)()?void 0:a()},get"aria-valuemin"(){return e.minValue},get"aria-valuemax"(){return e.maxValue},get"aria-valuetext"(){return g()},get"aria-labelledby"(){return c()}},m,d))}})}function N(t){const r=V();return s(_,$({as:"div"},()=>r.dataset(),t))}function O(t){const r=V();return s(_,$({as:"div"},()=>r.dataset(),t,{get children(){return r.valueLabel()}}))}var b=Object.assign(G,{Fill:j,Label:E,Track:N,ValueLabel:O}),ie=I("<div class=flex><!$><!/><!$><!/>"),ce=I('<div class="flex justify-center"><div class="grow border-r border-zinc-700"><div class="flex p-4 flex-col"><!$><!/><!$><!/></div></div><div class="grow p-4 overflow-y-auto">'),ue=I("<div>");const ve=()=>{const t=se(),[r,i]=S(0),[e,d]=S([]);K(async()=>{await t.engine.wait()});const c=a=>{d(n=>[...n,`${a}`])},L=a=>{d(n=>[...n.slice(0,-1),a])},C=async()=>{d([]),i(2),c("fetching positions");const a=await t.openingGraph.getMostCommonPositions("white");c(`found ${a.length} positions`),i(10),c("sorting..."),a.sort((o,l)=>l.count-o.count),c("narrowed down 100 positions"),i(14);const n=120,g=a.slice(0,n),x=66/n;let m=0;const p=[];c("Analyzing..."),c("");for(const o of g){const l=await t.engine.wait_for(o.fen);p.push(l),L(`${m}%`),m+=1,i(h=>h+x)}for(const o of p){const l=await t.openingGraph.getPosition(o.fen,"white",oe(o.fen)),h=o.lines.map(f=>f.san.at(0)?.toLowerCase()),y=Object.entries(l?.moves).map(f=>f[1].uci.toLowerCase());let u=!1;for(const f of y)if(h.includes(f)){u=!0;break}u||c(`${l?.fen}: ${Math.round(l?.result.white*100/(l?.result.black+l?.result.white+l?.result.draw))}%`)}};return(()=>{var a=k(ce),n=a.firstChild,g=n.firstChild,x=g.firstChild,[m,p]=P(x.nextSibling),o=m.nextSibling,[l,h]=P(o.nextSibling),y=n.nextSibling;return v(g,s(ne,{class:"button",onClick:()=>C(),children:"build"}),m,p),v(g,s(b,{get value(){return r()},get children(){return[(()=>{var u=k(ie),f=u.firstChild,[w,q]=P(f.nextSibling),z=w.nextSibling,[B,W]=P(z.nextSibling);return v(u,s(b.Label,{get children(){return r()<100?"Loading...":"done!"}}),w,q),v(u,s(Q,{get when(){return r()<100},get children(){return s(b.ValueLabel,{})}}),B,W),u})(),s(b.Track,{class:"h-2 w-full bg-gray-700",get children(){return s(b.Fill,{class:"w-[var(--kb-progress-fill-width)] h-full bg-red-50 transition-[width]"})}})]}}),l,h),v(y,s(X,{get each(){return e()},children:(u,f)=>(()=>{var w=k(ue);return v(w,u),w})()})),a})()};export{ve as default};
