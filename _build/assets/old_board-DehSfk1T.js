import{e as l,k as K,n as E,i as O,y as c,j as f,b as m,t as T,o as V}from"./web-DuEVvOp5.js";import{B as J}from"./BoardView-BhTIAIwV.js";import{C as Q}from"./chess-lriRiorr.js";import{u as U,s as W,t as B,p as X}from"./Context-D0aeQrfF.js";import{u as Y,E as Z,a as ee,b as te}from"./RepertoireCard-DZ_THEJ2.js";import{G as oe}from"./GameInterfaceCard-Dd9D52Wt.js";import{u as ne}from"./routing-Bp67eWU0.js";import"./index-HbBCBvHV.js";import"./UKTBL2JL-CnBKWN1M.js";import"./FN6EICGO-iZF3THgN.js";var re=T('<main class="flex flex-grow px-8 gap-6 py-6 justify-center relative "><!$><!/><div class="tools-container justify-start flex flex-grow shrink flex-col *:shrink gap-4 max-w-[500px] min-w-[300px] max-h-full overflow-auto"><!$><!/><!$><!/><!$><!/><!$><!/>');function de(){const d=U(),[h,M]=l(null),e=new Q,[i,$]=l([]);let r=0;const[_,A]=l(W()),[u,L]=l("white"),[v,y]=l(!1),[S,se]=ne(),b=Y();K(async()=>{S.fen?setTimeout(()=>{e.load(S.fen),a()},100):a()}),E(V(b,()=>{const t=b();if(t){if(t.key==="ArrowLeft"){const o=i().slice(0,Math.max(0,r));r=Math.max(-1,r-1),e.reset();for(const s of o)e.move(s);a()}if(t.key==="ArrowRight"){r=Math.min(i().length-1,r+1);const o=i().slice(0,r+1);e.reset();for(const s of o)e.move(s);a()}}}));const a=()=>{const t=e.fen();console.log(t),d.engine.enqueue_main(t),A(t);const o=e.turn()==="w"?"white":"black";h()?.set({turnColor:o,orientation:u(),fen:e.fen(),movable:{color:o,free:!1,dests:B(e)}})},g=t=>{const o=e.fen();try{e.move(t)}catch{e.load(o)}$(e.history()),r=i().length-1,a()},P=(t,o)=>{const s=t+o,p=e.fen(),n=X(p,s);if(n){if(v()){d.repertoire.addLine(p,n),y(!1);return}g(n)}},R=()=>{console.log("reset"),e.reset(),$(e.history()),r=-1,a()};return E(()=>{h()?.set({orientation:u(),movable:{color:"white",dests:B(e),events:{after:P}}})}),(()=>{var t=O(re),o=t.firstChild,[s,p]=c(o.nextSibling),n=s.nextSibling,j=n.firstChild,[w,F]=c(j.nextSibling),q=w.nextSibling,[C,D]=c(q.nextSibling),G=C.nextSibling,[k,I]=c(G.nextSibling),N=k.nextSibling,[z,H]=c(N.nextSibling);return f(t,m(J,{setApi:M,class:"",get style(){return{border:v()?"3px solid red":""}}}),s,p),f(n,m(Z,{onSelect:x=>g(x)}),w,F),f(n,m(oe,{history:i,restart:()=>R(),setOrientation:L}),C,D),f(n,m(ee,{get fen(){return _()},requestLine:()=>y(!0)}),k,I),f(n,m(te,{get fen(){return _()},get playerColor(){return u()},onSelect:x=>g(x)}),z,H),t})()}export{de as default};
