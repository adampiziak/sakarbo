const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ClientOnlyGraph-CIdXmOrN.js","assets/web-DuEVvOp5.js","assets/Context-D0aeQrfF.js","assets/chess-lriRiorr.js"])))=>i.map(i=>d[i]);
import{_ as x}from"./preload-helper-N37mDRhq.js";import{e as m,k as S,i as b,j as G,b as T,E,t as F}from"./web-DuEVvOp5.js";import{u as O,S as k,b as A,g as C}from"./Context-D0aeQrfF.js";import{c as M}from"./clientOnly-DsafAS6x.js";import"./chess-lriRiorr.js";function u(t,i,a){this.k=t,this.x=i,this.y=a}u.prototype={constructor:u,scale:function(t){return t===1?this:new u(this.k*t,this.x,this.y)},translate:function(t,i){return t===0&i===0?this:new u(this.k,this.x+this.k*t,this.y+this.k*i)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};u.prototype;var N=F('<div class="graph-page flex-grow bg-pink-500">');const X=M(()=>x(()=>import("./ClientOnlyGraph-CIdXmOrN.js"),__vite__mapDeps([0,1,2,3]))),P=()=>{const t=O(),[i,a]=m(k),[d,h]=m(null);let e;return S(async()=>{await t.openingGraph.load_wait(),await t.repertoire.load();const n=await t.openingGraph.getAllSplit(),o=await t.repertoire.getAll();if(e){console.log(e);const c=Y(e.offsetWidth,e.offsetHeight,n,a,o);setTimeout(()=>{h(c),h(c),console.log(c)},300)}}),(()=>{var n=b(N),o=e;return typeof o=="function"?E(o,n):e=n,G(n,T(X,{get data(){return d()}})),n})()},Y=(t,i,a,d,h)=>{const e=new Map,n=[],o=[],c=new Set;for(const s of h)c.add(s.fen);let g=0,v="black",l=[a.blackwhite.get(k)];for(e.set(l[0].fen,{id:l[0].fen,count:l[0].count,color:"#222222"});g<500;){l.sort((p,f)=>f?.count-p?.count);const s=l.shift();if(!s)break;for(const p of Object.values(s.moves)){const f=A(s.fen,p.uci),y=C(f),_=v+y,r=a[_].get(f);if(r&&r.count>1){const w=c.has(r.fen)?"#304FFE":"#222222";e.set(r.fen,{id:r?.fen,val:r?.count,color:w}),o.push({source:s.fen,target:r.fen,value:p.count,color:"#333333"}),l.push(r)}}g+=1}for(const s of e.values())n.push(s);return console.log("COUNT"),console.log(g),console.log("done1"),console.log(n.length),console.log(o.length),{nodes:n,links:o}};export{P as default};
