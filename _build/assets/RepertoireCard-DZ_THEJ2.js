import{m as K}from"./index-HbBCBvHV.js";import{i as x,s as A,m as Q,r as j,t as v,f as U,d as W,g as X,e as w,h as B,k as D,y,j as l,b as _,F as L,n as F}from"./web-DuEVvOp5.js";import{u as I,e as Y}from"./Context-D0aeQrfF.js";import{C as R}from"./chess-lriRiorr.js";import{l as Z}from"./UKTBL2JL-CnBKWN1M.js";var ee=v('<svg width=24px height=24px stroke-width=1.5 viewBox="0 0 24 24"fill=none xmlns=http://www.w3.org/2000/svg color=currentcolor><path d="M21.1679 8C19.6247 4.46819 16.1006 2 11.9999 2C6.81459 2 2.55104 5.94668 2.04932 11"stroke=currentcolor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M17 8H21.4C21.7314 8 22 7.73137 22 7.4V3"stroke=currentcolor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M2.88146 16C4.42458 19.5318 7.94874 22 12.0494 22C17.2347 22 21.4983 18.0533 22 13"stroke=currentcolor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round></path><path d="M7.04932 16H2.64932C2.31795 16 2.04932 16.2686 2.04932 16.6V21"stroke=currentcolor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round>'),te=v('<svg width=17px height=20px viewBox="0 0 17 20"xmlns=http://www.w3.org/2000/svg><g id=draggable transform=translate(5,4)><circle cx=1 cy=1 r=1.48 fill=currentcolor></circle><circle cx=1 cy=6.5 r=1.48 fill=currentcolor></circle><circle cx=1 cy=12 r=1.48 fill=currentcolor></circle><circle cx=6.3 cy=1 r=1.48 fill=currentcolor></circle><circle cx=6.3 cy=6.5 r=1.48 fill=currentcolor></circle><circle cx=6.3 cy=12 r=1.48 fill=currentcolor>');function pe(c){return(()=>{var a=x(ee);return A(a,c,!0,!0),j(),a})()}function H(c){return(()=>{var a=x(te);return A(a,Q(c,{color:"currentcolor"}),!0,!0),j(),a})()}function re(c,a=X()){let o=0,b,g;return()=>(o++,U(()=>{o--,queueMicrotask(()=>{!o&&g&&(g(),g=b=void 0)})}),g||W($=>b=c(g=$),a),b)}var me=re(()=>{const[c,a]=w(null);return K(window,"keydown",o=>{a(o),setTimeout(()=>a(null))}),c}),ne=v("<div class=text-nowrap>"),ce=v('<div class="mr-1 text-nowrap">'),le=v('<div class="hover:bg-accent-200 bg-accent-50 dark:bg-accent-900 [&amp;:not(:last-child)]:border-b border-accent-300 dark:border-accent-800 py-2 px-2 flex gap-4"><div class="w-[32px] grow-0 shrink-0 font-semibold text-right"></div><div class="flex flex-shrink justify-start gap-1 overflow-hidden">'),ae=v('<div class="border border-accent-200 dark:border-accent-700 bg-accent-100 dark:bg-accent-900 rounded"><div class="card-header text-accent-600 bg-accent-900 flex justify-between dark:text-accent-50 items-center"><!$><!/><div class="mr-2 ">Engine</div><div class="font-normal "></div><div class="text-xs uppercase ml-2 grow dark:text-accent-500 text-accent-700 text-right mr-2"></div><div class="dark:text-zinc-100 text-accent-700 text-right"><span class=""></span><span class=""> <!$><!/></span></div></div><div class="text-accent-700 bg-accent-100 dark:text-accent-300">');const ie=c=>{const a=I(),[o,b]=w({...Y});D(()=>{a.engine.subscribe_main(i=>{b(i)})});const g=i=>{c.onSelect&&c.onSelect(i)},$=i=>{const s=i.score;let f="   ";s!==0&&(f=s>0?"+":"-");const p=(t,e)=>{let n="";return e%2==0?(n=`${Math.floor(e/2)+1}.`,(()=>{var r=x(ne);return l(r,`${n}${t}`),r})()):(()=>{var r=x(ce);return l(r,`${t}`),r})()},m=`${f}${Math.abs(s)}`;return(()=>{var t=x(le),e=t.firstChild,n=e.nextSibling;return t.$$click=()=>g(i.san[0]),l(e,m),l(n,_(L,{get each(){return i.san},children:(r,d)=>p(r,d())})),j(),t})()};return(()=>{var i=x(ae),s=i.firstChild,f=s.firstChild,[p,m]=y(f.nextSibling),t=p.nextSibling,e=t.nextSibling,n=e.nextSibling,r=n.nextSibling,d=r.firstChild,u=d.nextSibling,h=u.firstChild,S=h.nextSibling,[C,k]=y(S.nextSibling),E=s.nextSibling;return l(s,_(H,{class:"w-4 text-accent-600 mr-1"}),p,m),l(e,()=>o().mode),l(n,()=>o().cached?"cached":""),l(u,()=>o().depth,C,k),l(E,_(L,{get each(){return o().lines},children:(T,N)=>$(T)})),i})()},_e=ie;B(["click"]);var oe=v('<tr class="lvl-1 hoverable"><td class=font-medium><!$><!/><span class=px-1></span></td><td></td><td class="bg-pink relative w-full h-full "><div class="flex *:text-center overflow-hidden *:h-4 *:leading-4 items-center rounded font-normal dark:font-medium border border-zinc-400/60 dark:border-0 "><div class="dark:bg-accent-300 dark:text-accent-800 bg-accent-50 text-accent-600"></div><div class="dark:bg-accent-500 dark:text-accent-800 bg-accent-300 text-accent-700"></div><div class="dark:bg-accent-900 dark:text-accent-600 bg-accent-500 text-accent-50">'),se=v('<div class="bg-accent-100 text-accent-800 dark:bg-accent-800 dark:text-accent-100 border border-accent-200 dark:border-accent-700 rounded"><div class="bg-accent-200 card-header flex items-center"><!$><!/><div>Explorer</div></div><table class=sk-table><thead><tr class=*:font-normal><th>move</th><th>games</th><th>result</th></tr></thead><tbody>');const de=c=>{w("player");const a=I();let o=!1;const[b,g]=w([]),[$,i]=w(null);let s=null;F(async()=>{const t=c.fen,e=c.playerColor,n=new R;n.load(t);const r=n.turn()==="w"?"white":"black";if(s?.moves){const d=new R;for(const u of s.moves){const h=u.notation.notation;if(d.fen()===t){i(h);break}d.move(h)}}await f(t,e,r)}),D(async()=>{await a.openingGraph.load_wait(),o=!0,s=JSON.parse(localStorage.getItem("lastgame"));const t=c.fen,e=c.playerColor,n=new R;n.load(t);const r=new R;for(const u of s.moves){const h=u.notation.notation;if(r.fen()===t){i(h);break}r.move(h)}const d=n.turn()==="w"?"white":"black";await f(t,e,d)});const f=async(t,e,n)=>{o||(await a.openingGraph.load_wait(),o=!0),a.openingGraph.getFen(t,e,n).then(r=>{g(r)})},p=t=>{c.onSelect&&c.onSelect(t)},m=t=>{const e=t[1],n=e.result.black+e.result.white+e.result.draw,r=Math.ceil(e.result.white/n*100),d=Math.ceil(e.result.black/n*100),u=Math.ceil(e.result.draw/n*100),h=r>5?`${r}%`:"",S=u>5?`${u}%`:"",C=d>5?`${d}%`:"";return(()=>{var k=x(oe),E=k.firstChild,T=E.firstChild,[N,V]=y(T.nextSibling),z=N.nextSibling,q=E.nextSibling,O=q.nextSibling,J=O.firstChild,M=J.firstChild,P=M.nextSibling,G=P.nextSibling;return k.$$click=()=>p(e.uci),l(E,()=>e.uci,N,V),l(z,()=>e.uci===$()?"*":""),l(q,()=>e.count),`${r}%`!=null?M.style.setProperty("width",`${r}%`):M.style.removeProperty("width"),l(M,h),`${u}%`!=null?P.style.setProperty("width",`${u}%`):P.style.removeProperty("width"),l(P,S),`${d}%`!=null?G.style.setProperty("width",`${d}%`):G.style.removeProperty("width"),l(G,C),j(),k})()};return(()=>{var t=x(se),e=t.firstChild,n=e.firstChild,[r,d]=y(n.nextSibling);r.nextSibling;var u=e.nextSibling,h=u.firstChild,S=h.nextSibling;return l(e,_(H,{class:" mr-1"}),r,d),l(S,_(L,{get each(){return b()},children:(C,k)=>m(C)})),t})()},ke=de;B(["click"]);var ue=v('<div class="bg-accent-100 rounded overflow-hidden dark:bg-accent-800 dark:border-accent-700 border text-accent-800 dark:text-accent-100"><div class="bg-accent-200 py-1 px-2 dark:bg-accent-700 font-medium">Repertoire</div><div class=p-2><!$><!/><!$><!/>'),ge=v('<div class="font-semibold p-2 dark:bg-accent-700 bg-accent-200 my-2 rounded hoverable">');const $e=c=>{const a=I(),[o,b]=w([]);F(async()=>{const $=c.fen;if($){const i=await a.repertoire.getLine($);b(i?.response??[])}});const g=()=>{console.log("line"),c.requestLine&&c.requestLine()};return(()=>{var $=x(ue),i=$.firstChild,s=i.nextSibling,f=s.firstChild,[p,m]=y(f.nextSibling),t=p.nextSibling,[e,n]=y(t.nextSibling);return l(s,_(Z,{onClick:()=>g(),class:"button",children:"Add Line"}),p,m),l(s,_(L,{get each(){return o()},children:(r,d)=>(()=>{var u=x(ge);return l(u,r),u})()}),e,n),$})()},we=$e;export{H as D,_e as E,pe as R,we as a,ke as b,me as u};
